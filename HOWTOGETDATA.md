äº†è§£ã§ã™ã€‚å…ˆã»ã©ã® **å®Œå…¨ç‰ˆ Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆ** ã®æ¦‚è¦ã¨ä½¿ã„æ–¹ã‚’ã¾ã¨ã‚ãŸ **Markdown ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

---

# æž¶ç©ºåº—èˆ—å£²ä¸Šãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ â€” ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## æ¦‚è¦

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€**æž¶ç©ºã®åº—èˆ—å£²ä¸Šãƒ‡ãƒ¼ã‚¿**ã‚’å«ã‚€è¤‡é›‘ã§å·¨å¤§ãª Excel ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚
ãƒ‡ãƒ¼ã‚¿ã¯ã™ã¹ã¦ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚Œã€ãƒ†ã‚¹ãƒˆã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ¤œè¨¼ã€ãƒ¬ãƒãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç¢ºèªãªã©ã«åˆ©ç”¨ã§ãã¾ã™ã€‚

å‡ºåŠ›ã•ã‚Œã‚‹ Excel ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ä»¥ä¸‹ã®ã‚·ãƒ¼ãƒˆãŒå«ã¾ã‚Œã¾ã™ï¼š

* **Products**
  å•†å“ãƒžã‚¹ã‚¿ï¼ˆ200 SKUï¼‰ã€‚ã‚«ãƒ†ã‚´ãƒªã€åŽŸä¾¡ã€å¸Œæœ›å°å£²ä¾¡æ ¼ï¼ˆMSRPï¼‰ã‚’å«ã‚€ã€‚
* **Stores**
  åº—èˆ—ãƒžã‚¹ã‚¿ï¼ˆ50 åº—èˆ—ï¼‰ã€‚åœ°åŸŸã€é–‹åº—æ—¥ã€ãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼åã‚’å«ã‚€ã€‚
* **Employees**
  å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ï¼ˆ500 åï¼‰ã€‚æ‰€å±žåº—èˆ—ã€å½¹è·ã€æŽ¡ç”¨æ—¥ãªã©ã‚’å«ã‚€ã€‚
* **Sales**
  å£²ä¸Šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 20,000 è¡Œï¼‰ã€‚

  * å„å–å¼•ã«ã¯æ—¥ä»˜ã€åº—èˆ—ã€å•†å“ã€æ•°é‡ã€å˜ä¾¡ã€å‰²å¼•ãŒå«ã¾ã‚Œã‚‹
  * **NetSale / TotalCost / Profit ã¯ Excel æ•°å¼ã§åŸ‹ã‚è¾¼ã¿**ï¼ˆExcel ä¸Šã§è‡ªå‹•è¨ˆç®—ã•ã‚Œã‚‹ï¼‰
* **MonthlySummary**
  å¹´æœˆã”ã¨ã® NetSale / TotalCost / Profit é›†è¨ˆï¼ˆå€¤ã¨ã—ã¦æ›¸ãå‡ºã—ï¼‰
* **PivotLike**
  ã‚«ãƒ†ã‚´ãƒª Ã— å¹´æœˆ ã®å£²ä¸Šã‚’ **SUMIFS é–¢æ•°**ã§é›†è¨ˆã™ã‚‹æ“¬ä¼¼ãƒ”ãƒœãƒƒãƒˆè¡¨
* **MonthlyChart**
  æœˆåˆ¥å£²ä¸Šã®æŽ¨ç§»ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã‚°ãƒ©ãƒ•ã‚’è²¼ã‚Šä»˜ã‘
* **README**
  ç”Ÿæˆæ—¥æ™‚ãƒ»è¡Œæ•°ãƒ»ç¯„å›²ãªã©ã®ãƒ¡ã‚¿æƒ…å ±

---

## å¿…è¦ãªç’°å¢ƒ

Python ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼š

```bash
pip install pandas numpy openpyxl matplotlib
```

---

## ä½¿ã„æ–¹

### åŸºæœ¬å®Ÿè¡Œ

```bash
python generate_complex_excel.py
```

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ `complex_huge_sample.xlsx` ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼ˆSales ã‚·ãƒ¼ãƒˆã¯ 20,000 è¡Œï¼‰ã€‚

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³

* `--rows` : Sales ã®è¡Œæ•°ã‚’æŒ‡å®šï¼ˆä¾‹ï¼š50,000 è¡Œï¼‰
* `--out` : å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®š
* `--seed` : ä¹±æ•°ã‚·ãƒ¼ãƒ‰ã‚’æŒ‡å®šï¼ˆåŒã˜ã‚·ãƒ¼ãƒ‰ãªã‚‰å†ç¾å¯èƒ½ï¼‰

ä¾‹ï¼š

```bash
# 50,000 è¡Œã® Sales ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
python generate_complex_excel.py --rows 50000 --out store_sales_50k.xlsx --seed 42
```

---

## å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å¾´

* **Sales ã‚·ãƒ¼ãƒˆ**

  * åˆ— L: `NetSale = Quantity * UnitPrice * (1 - Discount)`
  * åˆ— M: `TotalCost = VLOOKUP(ProductID, Products!A:D, 4, FALSE) * Quantity`
  * åˆ— N: `Profit = NetSale - TotalCost`
  * â†’ Excel ã‚’é–‹ãã¨è‡ªå‹•è¨ˆç®—ã•ã‚Œã‚‹

* **MonthlySummary**

  * å¹´æœˆå˜ä½ã§å£²ä¸Šã‚’é›†è¨ˆï¼ˆNetSale / TotalCost / Profitï¼‰

* **PivotLike**

  * å„ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«å¹´æœˆåˆ¥å£²ä¸Šã‚’ **SUMIFS** ã§é›†è¨ˆ
  * ä¾‹:
    `=SUMIFS(Sales!L:L, Sales!H:H,"Beverages", Sales!B:B,">=2023-01-01", Sales!B:B,"<=2023-01-31")`

* **MonthlyChart**

  * `MonthlySummary` ã‚’åŸºã«æç”»ã—ãŸã‚°ãƒ©ãƒ•ã‚’ç”»åƒã¨ã—ã¦è²¼ä»˜

---

## å¿œç”¨

* `--rows` ã‚’å¤§ããã™ã‚Œã°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãƒ†ã‚¹ãƒˆç”¨ã®å·¨å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆå¯èƒ½
* ã‚«ãƒ©ãƒ ã‚„ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒžã‚’æ‹¡å¼µã—ã¦ã€é¡§å®¢å±žæ€§ãƒ»æ±ºæ¸ˆæ–¹æ³•ãƒ»è¿”å“æƒ…å ±ãªã©ã‚’è¿½åŠ å¯èƒ½
* æœ¬ç‰©ã®ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ãŸã„å ´åˆã¯ã€VBA ã‚„ Excel COM ã‚’çµ„ã¿åˆã‚ã›ã‚‹å¿…è¦ã‚ã‚Š

---

ðŸ‘‰ ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ **ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ**ã«æœ€é©ã§ã™ã€‚æœ¬ç•ªåˆ©ç”¨ã™ã‚‹å ´åˆã¯å®Ÿãƒ‡ãƒ¼ã‚¿ã¨æ··åŒã—ãªã„ã‚ˆã†æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

---

ã“ã®èª¬æ˜Žæ–‡ã‚’ README.md ã«ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åŒæ¢±ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚

---

ã”å¸Œæœ›ãªã‚‰ã€ã“ã® **Markdown ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ README.md ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ Python ã‚³ãƒ¼ãƒ‰** ã‚‚è¿½åŠ ã§æ›¸ãã¾ã™ã‹ï¼Ÿ
